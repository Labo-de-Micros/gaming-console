//////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////
//	@file		I2C.h   										//
//	@brief		I2C communication protocol driver implementation//
//	@author		Grupo	4										//
//////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////

#ifndef I2C_H_
#define I2C_H_

//////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////
//							Headers								//
//////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////

#include <stdint.h>
#include <stdbool.h>

//////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////
//		CONSTANT AND MACRO DEFINITIONS USING #DEFINE 		 	//
//////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////
//			ENUMERATIONS AND STRUCTURES AND TYPEDEFS			//
//////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////

typedef void (* pfunc) (void);

typedef enum{
	I2C_NO_FAULT,
	I2C_BUS_BUSY,
	I2C_TIMEOUT,
	I2C_SLAVE_ERROR,
}I2C_FAULT;

typedef struct{
	pfunc callback;				// Callback for when the transfer is finished
	I2C_FAULT fault;			// Fault saved of the transfer, important to check in the callback.
	uint8_t * data;				// Pointer to data buffer
	uint8_t data_size; 			// Amount of Bytes
	uint8_t slave_address;		// Address of the module to communicate with
	uint8_t register_address;	// Register address of the given module to communicate.
}I2C_COM_CONTROL;

typedef enum {I2C_0, I2C_1, I2C_2}I2C_ChannelType;

//////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////
//			FUNCTION PROTOTYPES WITH GLOBAL SCOPE				//
//////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////

void I2C_init(I2C_ChannelType channel);
/*****************************************************************
 * @brief Function to initialize I2C Driver module
 * @param channel: Channel of the I2C to initialize. I2C0, I2C1, I2C2
 ****************************************************************/

bool I2C_init_transcieve(I2C_COM_CONTROL * i2c_comm, bool read);
/*****************************************************************
 * @brief Function to write a message from the I2C module
 * @param i2c_comm: Pointer to communication parameters.
 * @returns: true if communication started, false otherwise.
 ****************************************************************/

#endif /* I2C_H_ */